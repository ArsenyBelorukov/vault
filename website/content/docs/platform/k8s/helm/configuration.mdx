---
layout: docs
page_title: Configuration
description: This section documents configuration options for the Vault Helm chart
---

# Configuration

@include 'helm/version.mdx'

The chart is highly customizable using
[Helm configuration values](https://helm.sh/docs/intro/using_helm/#customizing-the-chart-before-installing).
Each value has a default tuned for an optimal getting started experience
with Vault. Before going into production, please review the parameters below
and consider if they're appropriate for your deployment.

<!-- codegen: start -->

## global

- `global` - These global values affect multiple components of the chart.

  - `enabled` (`boolean: true`) - The global enabled/disabled configuration. If this is true, most components will be installed by default. If this is false, no components will be installed by default and manually opting-in is required, such as by setting `server.enabled` to true.

  - `imagePullSecrets` (`array: []`) - References secrets to be used when pulling images from private registries. See [Pull an Image from a Private Registry](https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/) for more details. May be specified as an array of name map entries or just as an array of names:


    ```yaml
    imagePullSecrets:
      - name: image-pull-secret
    # or
    imagePullSecrets:
      - image-pull-secret
    ```

  - `tlsDisable` (`boolean: true`) - When set to `true`, changes URLs from `https` to `http` (such as the `VAULT_ADDR=http://127.0.0.1:8200` environment variable set on the Vault pods).

  - `externalVaultAddr` (`string: ""`) - External vault server address for the injector and CSI provider to use. Setting this will disable deployment of a vault server. A service account with token review permissions is automatically created if `server.serviceAccount.create=true` is set for the external Vault server  to use.

  - `openshift` (`boolean: false`) - If `true`, enables configuration specific to OpenShift such as NetworkPolicy, SecurityContext, and Route.

  - `psp` - Values that configure Pod Security Policy.

    - `enable` (`boolean: false`) - When set to `true`, enables Pod Security Policies for Vault and Vault Agent Injector.

    - `annotations` (`string`) - This value defines additional annotations to add to the Pod Security Policies. This can either be YAML or a YAML-formatted multi-line templated string.


      ```yaml
      annotations:
        seccomp.security.alpha.kubernetes.io/allowedProfileNames: docker/default,runtime/default
        apparmor.security.beta.kubernetes.io/allowedProfileNames: runtime/default
        seccomp.security.alpha.kubernetes.io/defaultProfileName:  runtime/default
        apparmor.security.beta.kubernetes.io/defaultProfileName:  runtime/default
      # or
      annotations: |
        seccomp.security.alpha.kubernetes.io/allowedProfileNames: docker/default,runtime/default
        apparmor.security.beta.kubernetes.io/allowedProfileNames: runtime/default
        seccomp.security.alpha.kubernetes.io/defaultProfileName:  runtime/default
        apparmor.security.beta.kubernetes.io/defaultProfileName:  runtime/default
      ```

  - `serverTelemetry` - Values that configure metrics and telemetry.

    - `prometheusOperator` (`boolean: false`) -  When set to `true`, enables integration with the Prometheus Operator. Be sure to configure the top-level [`serverTelemetry`](/vault/docs/platform/k8s/helm/configuration#servertelemetry-1) section for more details and required configuration values.

## injector

- `injector` - Values that configure running a Vault Agent Injector Admission Webhook Controller within Kubernetes.

  - `enabled` (`string: global.enabled`) - When set to `true`, the Vault Agent Injector Admission Webhook controller will be created. When set to `"-"`, defaults to the value of `global.enabled`.

  - `externalVaultAddr` (`string: ""`) - Deprecated: Please use [global.externalVaultAddr](/vault/docs/platform/k8s/helm/configuration#externalvaultaddr) instead.

  - `replicas` (`integer: 1`) - The number of pods to deploy to create a highly available cluster of Vault Agent Injectors. Requires Vault K8s 0.7.0 to have more than 1 replica.

  - `leaderElector` - Values that configure the Vault Agent Injector leader election for HA deployments.

    - `enabled` (`boolean: true`) - When set to `true`, enables leader election for Vault Agent Injector. This is required when using auto-tls and more than 1 replica.

  - `image` - Values that configure the Vault Agent Injector Docker image.

    - `repository` (`string: hashicorp/vault-k8s`) - The name of the Docker image for Vault Agent Injector.

    - `tag` (`string: 1.2.1`) - The tag of the Docker image for the Vault Agent Injector. **This should be pinned to a specific version when running in production.** Otherwise, other changes to the chart may inadvertently upgrade your admission controller.

    - `pullPolicy` (`string: IfNotPresent`) - The pull policy for container images. The default pull policy is `IfNotPresent` which causes the Kubelet to skip pulling an image if it already exists.

  - `agentImage` - Values that configure the Vault Agent sidecar image.

    - `repository` (`string: hashicorp/vault`) - The name of the Docker image for the Vault Agent sidecar. This should be set to the official Vault Docker image.

    - `tag` (`string: 1.13.1`) - The tag of the Vault Docker image to use for the Vault Agent Sidecar. **Vault 1.3.1+ is required by the admission controller**.

  - `agentDefaults` - Values that configure the injected Vault Agent containers default values. For more information on configuring resources, see the K8s documentation: https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/

    - `cpuLimit` (`string: 500m`) - The default CPU limit for injected Vault Agent containers.

    - `cpuRequest` (`string: 250m`) - The default CPU request for injected Vault Agent containers.

    - `memLimit` (`string: 128Mi`) - The default memory limit for injected Vault Agent containers.

    - `memRequest` (`string: 64Mi`) - The default memory request for injected Vault Agent containers.

    - `template` (`string: map`) - The default template type for rendered secrets if no custom templates are defined. Possible values include `map` and `json`.

    - `templateConfig` - Default values within Agent's [`template_config` stanza](/vault/docs/agent/template).

      - `exitOnRetryFailure` (`boolean: true`) - Controls whether Vault Agent exits after it has exhausted its number of template retry attempts due to failures.

      - `staticSecretRenderInterval` (`string: ""`) - Configures how often Vault Agent Template should render non-leased secrets such as KV v2. See the [Vault Agent Templates documentation](/docs/agent/template#non-renewable-secrets) for more details.

  - `metrics` - Values that configure the Vault Agent Injector metric exporter.

    - `enabled` (`boolean: false`) - When set to `true`, the Vault Agent Injector exports Prometheus metrics at the `/metrics` path.

  - `authPath` (`string: auth/kubernetes`) - Mount path of the Vault Kubernetes Auth Method.

  - `logLevel` (`string: info`) - Configures the log verbosity of the injector. Supported log levels: trace, debug, error, warn, info.

  - `logFormat` (`string: standard`) - Configures the log format of the injector. Supported log formats: "standard", "json".

  - `revokeOnShutdown` (`boolean: false`) - Configures all Vault Agent sidecars to revoke their token when shutting down.

  - `securityContext` - Security context for the pod template and the injector container.

    - `pod` - Defines the securityContext for the injector Pod, as YAML or a YAML-formatted multi-line templated string. Default if not specified:


      ```yaml
      runAsNonRoot: true
      runAsGroup: {{ .Values.injector.gid | default 1000 }}
      runAsUser: {{ .Values.injector.uid | default 100 }}
      fsGroup: {{ .Values.injector.gid | default 1000 }}
      ```

    - `container` - Defines the securityContext for the injector container, as YAML or a YAML-formatted multi-line templated string. Default if not specified:


      ```yaml
      allowPrivilegeEscalation: false
      capabilities:
        drop:
          - ALL
      ```

  - `resources` - The resource requests and limits (CPU, memory, etc.) for each container of the injector. This should be a YAML dictionary of a Kubernetes [ResourceRequirements](https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.24/#resourcerequirements-v1-core) object. If this isn't specified, then the pods won't request any specific amount of resources, which limits the ability for Kubernetes to make efficient use of compute resources.

 **Setting this is highly recommended.**


    ```yaml
    resources:
      requests:
        memory: '256Mi'
        cpu: '250m'
      limits:
        memory: '256Mi'
        cpu: '250m'
    ```

  - `webhook` - Values that control the Mutating Webhook Configuration.

    - `failurePolicy` (`string: Ignore`) - Configures failurePolicy of the webhook. To block pod creation while the webhook is unavailable, set the policy to `"Fail"`. See [Failure Policy](https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#failure-policy).

    - `matchPolicy` (`string: Exact`) - Specifies the approach to accepting changes based on the rules of the MutatingWebhookConfiguration. See [Match Policy](https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#matching-requests-matchpolicy).

    - `timeoutSeconds` (`integer: 30`) - Specifies the number of seconds before the webhook request will be ignored or fails. If it is ignored or fails depends on the `failurePolicy`. See [timeouts](https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#timeouts).

    - `namespaceSelector` -  The selector used by the admission webhook controller to limit what namespaces where injection can happen. If unset, all non-system namespaces are eligible for injection. See [Matching requests: namespace selector](https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#matching-requests-namespaceselector).


      ```yaml
      namespaceSelector:
        matchLabels:
          sidecar-injector: enabled
      ```

    - `objectSelector` (`string`) -  The selector used by the admission webhook controller to limit what objects can be affected by mutation. See [Matching requests: object selector](https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#matching-requests-objectselector).


      ```yaml
      objectSelector:
        matchLabels:
          sidecar-injector: enabled
      ```

    - `annotations` - Defines additional annotations to attach to the webhook. This can either be YAML or a YAML-formatted multi-line templated string.

  - `namespaceSelector` - Deprecated: please use [`webhook.namespaceSelector`](/vault/docs/platform/k8s/helm/configuration#namespaceselector) instead.

  - `objectSelector` - Deprecated: please use [`webhook.objectSelector`](/vault/docs/platform/k8s/helm/configuration#objectselector) instead.

  - `extraLabels` -  This value defines additional labels for Vault Agent Injector pods.


    ```yaml
    extraLabels:
      'sample/label1': 'foo'
      'sample/label2': 'bar'
    ```

  - `certs` - The certs section configures how the webhook TLS certs are configured. These are the TLS certs for the Kube apiserver communicating to the webhook. By default, the injector will generate and manage its own certs, but this requires the ability for the injector to update its own `MutatingWebhookConfiguration`. In a production environment, custom certs should probably be used. Configure the values below to enable this.

    - `secretName` (`string: null`) - secretName is the name of the Kubernetes secret that has the TLS certificate and private key to serve the injector webhook. If this is null, then the injector will default to its automatic management mode.

    - `caBundle` (`string: ""`) - The PEM-encoded CA public certificate bundle for the TLS certificate served by the injector. This must be specified as a string and can't come from a secret because it must be statically configured on the Kubernetes `MutatingAdmissionWebhook` resource. This only needs to be specified if `secretName` is not null.

    - `certName` (`string: tls.crt`) - The name of the certificate file within the `secretName` secret.

    - `keyName` (`string: tls.key`) - The name of the key file within the `secretName` secret.

  - `extraEnvironmentVars` - Extra environment variables to set in the injector deployment.


    ```yaml
    # Example setting injector TLS options in a deployment:
    extraEnvironmentVars:
      AGENT_INJECT_TLS_MIN_VERSION: tls13
      AGENT_INJECT_TLS_CIPHER_SUITES: ...
    ```

  - `affinity` (`string`) - This value defines the [affinity](https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#affinity-and-anti-affinity) for Vault Agent Injector pods. This can either be multi-line string or YAML matching the PodSpec's affinity field. It defaults to allowing only a single pod on each node, which minimizes risk of the cluster becoming unusable if a node is lost. If you need to run more pods per node (for example, testing on Minikube), set this value to `null`.

 Recommended and default server affinity:


    ```yaml
    affinity: |
      podAntiAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
        - labelSelector:
            matchLabels:
              app.kubernetes.io/name: {{ template "vault.name" . }}-agent-injector
              app.kubernetes.io/instance: "{{ .Release.Name }}"
              component: webhook
          topologyKey: kubernetes.io/hostname
    ```

  - `topologySpreadConstraints` (`array: []`) - [Topology settings](https://kubernetes.io/docs/concepts/workloads/pods/pod-topology-spread-constraints/) for injector pods. This can either be YAML or a YAML-formatted multi-line templated string.

  - `tolerations` (`array: []`) - Toleration Settings for injector pods. This should be either a multi-line string or YAML matching the Toleration array.

  - `nodeSelector` - The nodeSelector labels for injector pod assignment, formatted as a multi-line string or YAML map. See https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#nodeselector

 nodeSelector:   beta.kubernetes.io/arch: amd64

  - `priorityClassName` (`string: ""`) - Priority class for injector pods.

  - `annotations` - This value defines additional annotations for injector pods. This can either be YAML or a YAML-formatted multi-line templated string.


    ```yaml
    annotations:
      "sample/annotation1": "foo"
      "sample/annotation2": "bar"
    # or
    annotations: |
      "sample/annotation1": "foo"
      "sample/annotation2": "bar"
    ```

  - `failurePolicy` (`string: Ignore`) - Deprecated: please use [`webhook.failurePolicy`](/vault/docs/platform/k8s/helm/configuration#failurepolicy) instead.

  - `webhookAnnotations` - Deprecated: please use [`webhook.annotations`](/vault/docs/platform/k8s/helm/configuration#annotations-1) instead.

  - `service` - The service section configures the Kubernetes service for the Vault Agent Injector.

    - `annotations` - This value defines additional annotations to add to the Vault Agent Injector service. This can either be YAML or a YAML-formatted multi-line templated string.


      ```yaml
      annotations:
        "sample/annotation1": "foo"
        "sample/annotation2": "bar"
      # or
      annotations: |
        "sample/annotation1": "foo"
        "sample/annotation2": "bar"
      ```

  - `serviceAccount` - Injector serviceAccount specific config.

    - `annotations` - Extra annotations to attach to the injector serviceAccount. This can either be YAML or a YAML-formatted multi-line templated string.

  - `hostNetwork` (`boolean: false`) - When set to true, configures the Vault Agent Injector to run on the host network. This is useful when alternative cluster networking is used.

  - `port` (`integer: 8080`) - Configures the port the Vault Agent Injector listens on.

  - `podDisruptionBudget` - A disruption budget limits the number of pods of a replicated application that are down simultaneously from voluntary disruptions.


    ```yaml
    podDisruptionBudget:
      maxUnavailable: 1
    ```

  - `strategy` - Strategy for updating the deployment. This can be a multi-line string or a YAML map.


    ```yaml
    strategy:
      rollingUpdate:
        maxSurge: 25%
        maxUnavailable: 25%
      type: RollingUpdate
    # or
    strategy: |
      rollingUpdate:
        maxSurge: 25%
        maxUnavailable: 25%
      type: RollingUpdate
    ```

  - `livenessProbe` - Values that configure the liveness probe for the injector.

    - `failureThreshold` (`integer: 2`) - When set to a value, configures how many probe failures will be tolerated by Kubernetes.

    - `initialDelaySeconds` (`integer: 5`) - Sets the initial delay of the liveness probe when the container starts.

    - `periodSeconds` (`integer: 2`) - When set to a value, configures how often (in seconds) to perform the probe.

    - `successThreshold` (`integer: 1`) - When set to a value, configures the minimum consecutive successes for the probe to be considered successful after having failed.

    - `timeoutSeconds` (`integer: 5`) - When set to a value, configures the number of seconds after which the probe times out.

  - `readinessProbe` - Values that configure the readiness probe for the injector.

    - `failureThreshold` (`integer: 2`) - When set to a value, configures how many probe failures will be tolerated by Kubernetes.

    - `initialDelaySeconds` (`integer: 5`) - Sets the initial delay of the readiness probe when the container starts.

    - `periodSeconds` (`integer: 2`) - When set to a value, configures how often (in seconds) to perform the probe.

    - `successThreshold` (`integer: 1`) - When set to a value, configures the minimum consecutive successes for the probe to be considered successful after having failed.

    - `timeoutSeconds` (`integer: 5`) - When set to a value, configures the number of seconds after which the probe times out.

  - `startupProbe` - Values that configure the startup probe for the injector.

    - `failureThreshold` (`integer: 12`) - When set to a value, configures how many probe failures will be tolerated by Kubernetes.

    - `initialDelaySeconds` (`integer: 5`) - Sets the initial delay of the startup probe when the container starts.

    - `periodSeconds` (`integer: 5`) - When set to a value, configures how often (in seconds) to perform the probe.

    - `successThreshold` (`integer: 1`) - When set to a value, configures the minimum consecutive successes for the probe to be considered successful after having failed.

    - `timeoutSeconds` (`integer: 5`) - When set to a value, configures the number of seconds after which the probe times out.

## server

- `server`

  - `enabled` (`string: -`) - If true, or "-" with global.enabled true, Vault server will be installed. See vault.mode in _helpers.tpl for implementation details.

  - `enterpriseLicense` - [Enterprise Only] This value refers to a Kubernetes secret that you have created that contains your enterprise license. If you are not using an enterprise image or if you plan to introduce the license key via another route, then leave secretName blank ("") or set it to null. Requires Vault Enterprise 1.8 or later.

    - `secretName` (`string: ""`) - The name of the Kubernetes secret that holds the enterprise license. The secret must be in the same namespace that Vault is installed into.

    - `secretKey` (`string: license`) - The key within the Kubernetes secret that holds the enterprise license.

  - `image` - Resource requests, limits, etc. for the server cluster placement. This should map directly to the value of the resources field for a PodSpec. By default no direct resource request is made.

    - `repository` (`string: hashicorp/vault`)

    - `tag` (`string: 1.13.1`)

    - `pullPolicy` (`string: IfNotPresent`) - Overrides the default Image Pull Policy

  - `updateStrategyType` (`string: OnDelete`) - Configure the Update Strategy Type for the StatefulSet See https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/#update-strategies

  - `logLevel` (`string: ""`) - Configure the logging verbosity for the Vault server. Supported log levels include: trace, debug, info, warn, error

  - `logFormat` (`string: ""`) - Configure the logging format for the Vault server. Supported log formats include: standard, json

  - `resources`

  - `ingress` - Ingress allows ingress services to be created to allow external access from Kubernetes to access Vault pods. If deployment is on OpenShift, the following block is ignored. In order to expose the service, use the route section below

    - `enabled` (`boolean: false`)

    - `labels`

    - `annotations` - traffic: external

    - `ingressClassName` (`string: ""`) - Optionally use ingressClassName instead of deprecated annotation. See: https://kubernetes.io/docs/concepts/services-networking/ingress/#deprecated-annotation

    - `pathType` (`string: Prefix`) - As of Kubernetes 1.19, all Ingress Paths must have a pathType configured. The default value below should be sufficient in most cases. See: https://kubernetes.io/docs/concepts/services-networking/ingress/#path-types for other possible values.

    - `activeService` (`boolean: true`) - When HA mode is enabled and K8s service registration is being used, configure the ingress to point to the Vault active service.

    - `hosts` (`array: ""`)

      - `host` (`string: chart-example.local`)

      - `paths` (`array: []`)

    - `extraPaths` (`array: []`) - # Extra paths to prepend to the host configuration. This is useful when working with annotation based services.

    - `tls` (`array: []`) - - path: /*   backend:     service:       name: ssl-redirect       port:         number: use-annotation

  - `route` - OpenShift only - create a route to expose the service By default the created route will be of type passthrough

    - `enabled` (`boolean: false`)

    - `activeService` (`boolean: true`) - When HA mode is enabled and K8s service registration is being used, configure the route to point to the Vault active service.

    - `labels`

    - `annotations`

    - `host` (`string: chart-example.local`)

    - `tls` - tls will be passed directly to the route's TLS config, which can be used to configure other termination methods that terminate TLS at the router

      - `termination` (`string: passthrough`)

  - `authDelegator` - authDelegator enables a cluster role binding to be attached to the service account.  This cluster role binding can be used to setup Kubernetes auth method.  https://www.vaultproject.io/docs/auth/kubernetes.html

    - `enabled` (`boolean: true`)

  - `extraInitContainers` - extraInitContainers is a list of init containers. Specified as a YAML list. This is useful if you need to run a script to provision TLS certificates or write out configuration files in a dynamic way.

  - `extraContainers` - extraContainers is a list of sidecar containers. Specified as a YAML list.

  - `shareProcessNamespace` (`boolean: false`) - shareProcessNamespace enables process namespace sharing between Vault and the extraContainers This is useful if Vault must be signaled, e.g. to send a SIGHUP for a log rotation

  - `extraArgs` (`string: ""`) - extraArgs is a string containing additional Vault server arguments.

  - `extraPorts` - extraPorts is a list of extra ports. Specified as a YAML list. This is useful if you need to add additional ports to the statefulset in dynamic way.

  - `readinessProbe` - Used to define custom readinessProbe settings

    - `enabled` (`boolean: true`)

    - `port` (`integer: 8200`) - Port number on which readinessProbe will be checked.

    - `failureThreshold` (`integer: 2`) - When a probe fails, Kubernetes will try failureThreshold times before giving up

    - `initialDelaySeconds` (`integer: 5`) - Number of seconds after the container has started before probe initiates

    - `periodSeconds` (`integer: 5`) - How often (in seconds) to perform the probe

    - `successThreshold` (`integer: 1`) - Minimum consecutive successes for the probe to be considered successful after having failed

    - `timeoutSeconds` (`integer: 3`) - Number of seconds after which the probe times out.

  - `livenessProbe` - Used to enable a livenessProbe for the pods

    - `enabled` (`boolean: false`)

    - `path` (`string: /v1/sys/health?standbyok=true`)

    - `port` (`integer: 8200`) - Port nuumber on which livenessProbe will be checked.

    - `failureThreshold` (`integer: 2`) - When a probe fails, Kubernetes will try failureThreshold times before giving up

    - `initialDelaySeconds` (`integer: 60`) - Number of seconds after the container has started before probe initiates

    - `periodSeconds` (`integer: 5`) - How often (in seconds) to perform the probe

    - `successThreshold` (`integer: 1`) - Minimum consecutive successes for the probe to be considered successful after having failed

    - `timeoutSeconds` (`integer: 3`) - Number of seconds after which the probe times out.

  - `terminationGracePeriodSeconds` (`integer: 10`) - Optional duration in seconds the pod needs to terminate gracefully. See: https://kubernetes.io/docs/concepts/containers/container-lifecycle-hooks/

  - `preStopSleepSeconds` (`integer: 5`) - Used to set the sleep time during the preStop step

  - `postStart` (`array: []`) - Used to define commands to run after the pod is ready. This can be used to automate processes such as initialization or boostrapping auth methods.

  - `extraEnvironmentVars` - extraEnvironmentVars is a list of extra environment variables to set with the stateful set. These could be used to include variables required for auto-unseal.

  - `extraSecretEnvironmentVars` (`array: []`) - extraSecretEnvironmentVars is a list of extra environment variables to set with the stateful set. These variables take value from existing Secret objects.

  - `extraVolumes` (`array: []`) - Deprecated: please use 'volumes' instead. extraVolumes is a list of extra volumes to mount. These will be exposed to Vault in the path `/vault/userconfig/<name>/`. The value below is an array of objects, examples are shown below.

  - `volumes` - volumes is a list of volumes made available to all containers. These are rendered via toYaml rather than pre-processed like the extraVolumes value. The purpose is to make it easy to share volumes between containers.

  - `volumeMounts` - volumeMounts is a list of volumeMounts for the main server container. These are rendered via toYaml rather than pre-processed like the extraVolumes value. The purpose is to make it easy to share volumes between containers.

  - `affinity` (`string`) - Affinity Settings Commenting out or setting as empty the affinity variable, will allow deployment to single node services such as Minikube This should be either a multi-line string or YAML matching the PodSpec's affinity field.

  - `topologySpreadConstraints` (`array: []`) - Topology settings for server pods ref: https://kubernetes.io/docs/concepts/workloads/pods/pod-topology-spread-constraints/ This should be either a multi-line string or YAML matching the topologySpreadConstraints array in a PodSpec.

  - `tolerations` (`array: []`) - Toleration Settings for server pods This should be either a multi-line string or YAML matching the Toleration array in a PodSpec.

  - `nodeSelector` - nodeSelector labels for server pod assignment, formatted as a multi-line string or YAML map. ref: https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#nodeselector Example: nodeSelector:   beta.kubernetes.io/arch: amd64

  - `networkPolicy` - Enables network policy for server pods

    - `enabled` (`boolean: false`)

    - `egress` (`array: []`)

  - `priorityClassName` (`string: ""`) - Priority class for server pods

  - `extraLabels` - Extra labels to attach to the server pods This should be a YAML map of the labels to apply to the server pods

  - `annotations` - Extra annotations to attach to the server pods This can either be YAML or a YAML-formatted multi-line templated string map of the annotations to apply to the server pods

  - `service` - Enables a headless service to be used by the Vault Statefulset

    - `enabled` (`boolean: true`)

    - `active` - Enable or disable the vault-active service, which selects Vault pods that have labelled themselves as the cluster leader with `vault-active: "true"`

      - `enabled` (`boolean: true`)

    - `standby` - Enable or disable the vault-standby service, which selects Vault pods that have labelled themselves as a cluster follower with `vault-active: "false"`

      - `enabled` (`boolean: true`)

    - `instanceSelector` - If enabled, the service selectors will include `app.kubernetes.io/instance: {{ .Release.Name }}` When disabled, services may select Vault pods not deployed from the chart. Does not affect the headless vault-internal service with `ClusterIP: None`

      - `enabled` (`boolean: true`)

    - `publishNotReadyAddresses` (`boolean: true`) - Configures the service type for the main Vault service.  Can be ClusterIP or NodePort. type: ClusterIP

 Do not wait for pods to be ready

    - `externalTrafficPolicy` (`string: Cluster`) - The externalTrafficPolicy can be set to either Cluster or Local and is only valid for LoadBalancer and NodePort service types. The default value is Cluster. ref: https://kubernetes.io/docs/concepts/services-networking/service/#external-traffic-policy

    - `port` (`integer: 8200`) - If type is set to "NodePort", a specific nodePort value can be configured, will be random if left blank. nodePort: 30000

 When HA mode is enabled If type is set to "NodePort", a specific nodePort value can be configured, will be random if left blank. activeNodePort: 30001

 When HA mode is enabled If type is set to "NodePort", a specific nodePort value can be configured, will be random if left blank. standbyNodePort: 30002

 Port on which Vault server is listening

    - `targetPort` (`integer: 8200`) - Target port to which the service should be mapped to

    - `annotations` - Extra annotations for the service definition. This can either be YAML or a YAML-formatted multi-line templated string map of the annotations to apply to the service.

  - `dataStorage` - This configures the Vault Statefulset to create a PVC for data storage when using the file or raft backend storage engines. See https://www.vaultproject.io/docs/configuration/storage/index.html to know more

    - `enabled` (`boolean: true`)

    - `size` (`string: 10Gi`) - Size of the PVC created

    - `mountPath` (`string: /vault/data`) - Location where the PVC will be mounted.

    - `storageClass` - Name of the storage class to use.  If null it will use the configured default Storage Class.

    - `accessMode` (`string: ReadWriteOnce`) - Access Mode of the storage device being used for the PVC

    - `annotations` - Annotations to apply to the PVC

  - `auditStorage` - This configures the Vault Statefulset to create a PVC for audit logs.  Once Vault is deployed, initialized, and unsealed, Vault must be configured to use this for audit logs.  This will be mounted to /vault/audit See https://www.vaultproject.io/docs/audit/index.html to know more

    - `enabled` (`boolean: false`)

    - `size` (`string: 10Gi`) - Size of the PVC created

    - `mountPath` (`string: /vault/audit`) - Location where the PVC will be mounted.

    - `storageClass` - Name of the storage class to use.  If null it will use the configured default Storage Class.

    - `accessMode` (`string: ReadWriteOnce`) - Access Mode of the storage device being used for the PVC

    - `annotations` - Annotations to apply to the PVC

  - `dev` - Run Vault in "dev" mode. This requires no further setup, no state management, and no initialization. This is useful for experimenting with Vault without needing to unseal, store keys, et. al. All data is lost on restart - do not use dev mode for anything other than experimenting. See https://www.vaultproject.io/docs/concepts/dev-server.html to know more

    - `enabled` (`boolean: false`)

    - `devRootToken` (`string: root`) - Set VAULT_DEV_ROOT_TOKEN_ID value

  - `standalone` - Run Vault in "standalone" mode. This is the default mode that will deploy if no arguments are given to helm. This requires a PVC for data storage to use the "file" backend.  This mode is not highly available and should not be scaled past a single replica.

    - `enabled` (`string: -`)

    - `config` (`string`) - config is a raw string of default configuration when using a Stateful deployment. Default is to use a PersistentVolumeClaim mounted at /vault/data and store data there. This is only used when using a Replica count of 1, and using a stateful set. This should be HCL.

 Note: Configuration files are stored in ConfigMaps so sensitive data such as passwords should be either mounted through extraSecretEnvironmentVars or through a Kube secret.  For more information see: https://www.vaultproject.io/docs/platform/k8s/helm/run#protecting-sensitive-vault-configurations

  - `ha` - Run Vault in "HA" mode. There are no storage requirements unless the audit log persistence is required.  In HA mode Vault will configure itself to use Consul for its storage backend.  The default configuration provided will work the Consul Helm project by default.  It is possible to manually configure Vault to use a different HA backend.

    - `enabled` (`boolean: false`)

    - `replicas` (`integer: 3`)

    - `apiAddr` - Set the api_addr configuration for Vault HA See https://www.vaultproject.io/docs/configuration#api_addr If set to null, this will be set to the Pod IP Address

    - `clusterAddr` - Set the cluster_addr confuguration for Vault HA See https://www.vaultproject.io/docs/configuration#cluster_addr If set to null, this will be set to https://$(HOSTNAME).{{ template "vault.fullname" . }}-internal:8201

    - `raft` - Enables Vault's integrated Raft storage.  Unlike the typical HA modes where Vault's persistence is external (such as Consul), enabling Raft mode will create persistent volumes for Vault to store data according to the configuration under server.dataStorage. The Vault cluster will coordinate leader elections and failovers internally.

      - `enabled` (`boolean: false`) - Enables Raft integrated storage

      - `setNodeId` (`boolean: false`) - Set the Node Raft ID to the name of the pod

      - `config` (`string`) - Note: Configuration files are stored in ConfigMaps so sensitive data such as passwords should be either mounted through extraSecretEnvironmentVars or through a Kube secret.  For more information see: https://www.vaultproject.io/docs/platform/k8s/helm/run#protecting-sensitive-vault-configurations

    - `config` (`string`) - config is a raw string of default configuration when using a Stateful deployment. Default is to use a Consul for its HA storage backend. This should be HCL.

 Note: Configuration files are stored in ConfigMaps so sensitive data such as passwords should be either mounted through extraSecretEnvironmentVars or through a Kube secret.  For more information see: https://www.vaultproject.io/docs/platform/k8s/helm/run#protecting-sensitive-vault-configurations

    - `disruptionBudget` - A disruption budget limits the number of pods of a replicated application that are down simultaneously from voluntary disruptions

      - `enabled` (`boolean: true`)

      - `maxUnavailable` - maxUnavailable will default to (n/2)-1 where n is the number of replicas. If you'd like a custom value, you can specify an override here.

  - `serviceAccount` - Definition of the serviceAccount used to run Vault. These options are also used when using an external Vault server to validate Kubernetes tokens.

    - `create` (`boolean: true`) - Specifies whether a service account should be created

    - `name` (`string: ""`) - The name of the service account to use. If not set and create is true, a name is generated using the fullname template

    - `annotations` - Extra annotations for the serviceAccount definition. This can either be YAML or a YAML-formatted multi-line templated string map of the annotations to apply to the serviceAccount.

    - `extraLabels` - Extra labels to attach to the serviceAccount This should be a YAML map of the labels to apply to the serviceAccount

    - `serviceDiscovery` - Enable or disable a service account role binding with the permissions required for Vault's Kubernetes service_registration config option. See https://developer.hashicorp.com/vault/docs/configuration/service-registration/kubernetes

      - `enabled` (`boolean: true`)

  - `statefulSet` - Settings for the statefulSet used to run Vault.

    - `annotations` - Extra annotations for the statefulSet. This can either be YAML or a YAML-formatted multi-line templated string map of the annotations to apply to the statefulSet.

    - `securityContext` - Set the pod and container security contexts. If not set, these will default to, and for *not* OpenShift: pod:   runAsNonRoot: true   runAsGroup: {{ .Values.server.gid | default 1000 }}   runAsUser: {{ .Values.server.uid | default 100 }}   fsGroup: {{ .Values.server.gid | default 1000 }} container:   allowPrivilegeEscalation: false

 If not set, these will default to, and for OpenShift: pod: {} container: {}

      - `pod`

      - `container`

  - `hostNetwork` (`boolean: false`) - Should the server pods run on the host network

## ui

- `ui` - Vault UI

  - `enabled` (`boolean: false`) - True if you want to create a Service entry for the Vault UI.

 serviceType can be used to control the type of service created. For example, setting this to "LoadBalancer" will create an external load balancer (for supported K8S installations) to access the UI.

  - `publishNotReadyAddresses` (`boolean: true`)

  - `activeVaultPodOnly` (`boolean: false`) - The service should only contain selectors for active Vault pod

  - `serviceType` (`string: ClusterIP`)

  - `serviceNodePort`

  - `externalPort` (`integer: 8200`)

  - `targetPort` (`integer: 8200`)

  - `externalTrafficPolicy` (`string: Cluster`) - The externalTrafficPolicy can be set to either Cluster or Local and is only valid for LoadBalancer and NodePort service types. The default value is Cluster. ref: https://kubernetes.io/docs/concepts/services-networking/service/#external-traffic-policy

  - `annotations` - loadBalancerSourceRanges:   - 10.0.0.0/16   - 1.78.23.3/32

 loadBalancerIP:

 Extra annotations to attach to the ui service This can either be YAML or a YAML-formatted multi-line templated string map of the annotations to apply to the ui service

## csi

- `csi` - secrets-store-csi-driver-provider-vault

  - `enabled` (`boolean: false`) - True if you want to install a secrets-store-csi-driver-provider-vault daemonset.

 Requires installing the secrets-store-csi-driver separately, see: https://github.com/kubernetes-sigs/secrets-store-csi-driver#install-the-secrets-store-csi-driver

 With the driver and provider installed, you can mount Vault secrets into volumes similar to the Vault Agent injector, and you can also sync those secrets into Kubernetes secrets.

  - `image`

    - `repository` (`string: hashicorp/vault-csi-provider`)

    - `tag` (`string: 1.3.0`)

    - `pullPolicy` (`string: IfNotPresent`)

  - `volumes` - volumes is a list of volumes made available to all containers. These are rendered via toYaml rather than pre-processed like the extraVolumes value. The purpose is to make it easy to share volumes between containers.

  - `volumeMounts` - volumeMounts is a list of volumeMounts for the main server container. These are rendered via toYaml rather than pre-processed like the extraVolumes value. The purpose is to make it easy to share volumes between containers.

  - `resources`

  - `hmacSecretName` (`string: ""`) - Override the default secret name for the CSI Provider's HMAC key used for generating secret versions.

  - `daemonSet` - Settings for the daemonSet used to run the provider.

    - `updateStrategy`

      - `type` (`string: RollingUpdate`)

      - `maxUnavailable` (`string: ""`)

    - `annotations` - Extra annotations for the daemonSet. This can either be YAML or a YAML-formatted multi-line templated string map of the annotations to apply to the daemonSet.

    - `providersDir` (`string: /etc/kubernetes/secrets-store-csi-providers`) - Provider host path (must match the CSI provider's path)

    - `kubeletRootDir` (`string: /var/lib/kubelet`) - Kubelet host path

    - `extraLabels` - Extra labels to attach to the vault-csi-provider daemonSet This should be a YAML map of the labels to apply to the csi provider daemonSet

    - `securityContext` - security context for the pod template and container in the csi provider daemonSet

      - `pod`

      - `container`

  - `pod`

    - `annotations` - Extra annotations for the provider pods. This can either be YAML or a YAML-formatted multi-line templated string map of the annotations to apply to the pod.

    - `tolerations` (`array: []`) - Toleration Settings for provider pods This should be either a multi-line string or YAML matching the Toleration array in a PodSpec.

    - `extraLabels` - Extra labels to attach to the vault-csi-provider pod This should be a YAML map of the labels to apply to the csi provider pod

  - `agent`

    - `enabled` (`boolean: true`)

    - `extraArgs` (`array: []`)

    - `image`

      - `repository` (`string: hashicorp/vault`)

      - `tag` (`string: 1.13.1`)

      - `pullPolicy` (`string: IfNotPresent`)

    - `logFormat` (`string: standard`)

    - `logLevel` (`string: info`)

    - `resources`

  - `priorityClassName` (`string: ""`) - Priority class for csi pods

  - `serviceAccount`

    - `annotations` - Extra annotations for the serviceAccount definition. This can either be YAML or a YAML-formatted multi-line templated string map of the annotations to apply to the serviceAccount.

    - `extraLabels` - Extra labels to attach to the vault-csi-provider serviceAccount This should be a YAML map of the labels to apply to the csi provider serviceAccount

  - `readinessProbe` - Used to configure readinessProbe for the pods.

    - `failureThreshold` (`integer: 2`) - When a probe fails, Kubernetes will try failureThreshold times before giving up

    - `initialDelaySeconds` (`integer: 5`) - Number of seconds after the container has started before probe initiates

    - `periodSeconds` (`integer: 5`) - How often (in seconds) to perform the probe

    - `successThreshold` (`integer: 1`) - Minimum consecutive successes for the probe to be considered successful after having failed

    - `timeoutSeconds` (`integer: 3`) - Number of seconds after which the probe times out.

  - `livenessProbe` - Used to configure livenessProbe for the pods.

    - `failureThreshold` (`integer: 2`) - When a probe fails, Kubernetes will try failureThreshold times before giving up

    - `initialDelaySeconds` (`integer: 5`) - Number of seconds after the container has started before probe initiates

    - `periodSeconds` (`integer: 5`) - How often (in seconds) to perform the probe

    - `successThreshold` (`integer: 1`) - Minimum consecutive successes for the probe to be considered successful after having failed

    - `timeoutSeconds` (`integer: 3`) - Number of seconds after which the probe times out.

  - `debug` (`boolean: false`) - Enables debug logging.

  - `extraArgs` (`array: []`) - Pass arbitrary additional arguments to vault-csi-provider. See https://www.vaultproject.io/docs/platform/k8s/csi/configurations#command-line-arguments for the available command line flags.

## serverTelemetry

- `serverTelemetry` - Vault is able to collect and publish various runtime metrics. Enabling this feature requires setting adding `telemetry{}` stanza to the Vault configuration. There are a few examples included in the `config` sections above.

 For more information see: https://www.vaultproject.io/docs/configuration/telemetry https://www.vaultproject.io/docs/internals/telemetry

  - `serviceMonitor` - Enable support for the Prometheus Operator. Currently, this chart does not support authenticating to Vault's metrics endpoint, so the following `telemetry{}` must be included in the `listener "tcp"{}` stanza  telemetry {    unauthenticated_metrics_access = "true"  }

 See the `standalone.config` for a more complete example of this.

 In addition, a top level `telemetry{}` stanza must also be included in the Vault configuration:

 example:  telemetry {    prometheus_retention_time = "30s"    disable_hostname = true  }

 Configuration for monitoring the Vault server.

    - `enabled` (`boolean: false`) - The Prometheus operator *must* be installed before enabling this feature, if not the chart will fail to install due to missing CustomResourceDefinitions provided by the operator.

 Instructions on how to install the Helm chart can be found here:  https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack More information can be found here:  https://github.com/prometheus-operator/prometheus-operator  https://github.com/prometheus-operator/kube-prometheus

 Enable deployment of the Vault Server ServiceMonitor CustomResource.

    - `selectors` - Selector labels to add to the ServiceMonitor. When empty, defaults to:  release: prometheus

    - `interval` (`string: 30s`) - Interval at which Prometheus scrapes metrics

    - `scrapeTimeout` (`string: 10s`) - Timeout for Prometheus scrapes

  - `prometheusRules`

      - `enabled` (`boolean: false`) - The Prometheus operator *must* be installed before enabling this feature, if not the chart will fail to install due to missing CustomResourceDefinitions provided by the operator.

 Deploy the PrometheusRule custom resource for AlertManager based alerts. Requires that AlertManager is properly deployed.

      - `selectors` - Selector labels to add to the PrometheusRules. When empty, defaults to:  release: prometheus

      - `rules` - Some example rules.
  <!-- codegen: end -->
  